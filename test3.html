<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Section 7 Parallax Drag: Bingung → Menghadapinya</title>

  <!-- Bootstrap (optional - biar class kamu jalan). Kalau project kamu sudah pakai Bootstrap, boleh hapus link ini -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* ====== Demo helper (boleh hapus kalau di project asli sudah ada) ====== */
    :root{
      --sec7-bg:#6b4fe6;
      --yellow:#ffc107;
      --purple-2:#f4f0ff;
      --purple-3:#3b2a7a;
    }
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#0b1020;}
    .bg-sec7{background:var(--sec7-bg);}
    .yellow-3{color:#ffcc00;}
    .purple-2{color:var(--purple-2);}
    .purple-3{color:var(--purple-3);}
    .poetsenOne{font-weight:900; letter-spacing:.03em;}
    .playpenSans{font-weight:700;}
    .fs-5vw{font-size:clamp(2rem,4vw,3.2rem);}
    .fs-4{font-size:1.05rem;}
    .fs-2{font-size:1.4rem;}
    .w-76{width:76%;}
    .w-26{width:26%;}
    .w-98{width:98%;}
    .w-83{width:83%;}
    .overflow-x-hidden{overflow-x:hidden;}
    /* ====== /Demo helper ====== */

    /* ===== SECTION 7 PARALLAX DRAG ===== */
    .bg-sec7 .sec7-leftWrap{
      position: relative;
      display: inline-block;
    }

    /* jalan bisa digeser pelan (parallax depth) */
    .bg-sec7 .sec7-road{
      will-change: transform;
      transform: translate3d(0,0,0);
    }

    /* tanda tanya jadi draggable handle */
    .bg-sec7 .jalanTanya{
      position: absolute;
      left: 52%;
      top: 22%;
      transform: translate(-50%, -50%);
      cursor: grab;
      touch-action: none;            /* penting untuk HP */
      -webkit-user-select: none;
      user-select: none;
      will-change: transform, opacity;
      z-index: 5;
    }
    .bg-sec7 .jalanTanya.dragging{ cursor: grabbing; }

    /* Idle animation untuk memancing dipegang */
    @keyframes sec7IdleFloat {
      0%   { transform: translate(-50%, -50%) scale(1); }
      40%  { transform: translate(calc(-50% + 6px), calc(-50% - 4px)) scale(1.03); }
      80%  { transform: translate(calc(-50% - 4px), calc(-50% + 3px)) scale(1.01); }
      100% { transform: translate(-50%, -50%) scale(1); }
    }
    .bg-sec7 .jalanTanya.idle{ animation: sec7IdleFloat 2.8s ease-in-out infinite; }

    /* Crossfade teks */
    .bg-sec7 .sec7-problem,
    .bg-sec7 .sec7-solution{
      transition: opacity .12s linear, filter .12s linear, transform .12s linear;
    }

    .bg-sec7 .sec7-solution{
      opacity: 0;
      filter: blur(10px);
      transform: translateY(12px);
    }

    .bg-sec7 .sec7-solution-card{
      background: rgba(255,255,255,0.92);
      border: 5px solid var(--yellow);
      border-radius: 24px;
      padding: 18px 18px;
      box-shadow: 0 18px 60px rgba(0,0,0,.25);
      will-change: transform;
    }

    .bg-sec7 .sec7-example{
      background: rgba(107,79,230,0.10);
      border-radius: 16px;
      padding: 12px 12px;
      font-weight: 800;
    }

    /* Biar kolom kiri ga “ngecil” banget di demo */
    .sec7-stage{
      min-height: 100vh;
      display:flex;
      align-items:center;
    }
  </style>
</head>

<body>

<!-- SECTION 7 (FULL) -->
<section class="container-fluid p-0 position-relative bg-sec7 sec7-stage">

  <div class="row g-0 position-relative overflow-x-hidden mt-5 w-100">
    <!-- LEFT -->
    <div class="col-12 col-lg-6 position-relative d-flex align-items-end justify-content-center">
      <div class="d-inline position-relative sec7-leftWrap" id="sec7LeftWrap">
        <!-- Jalan -->
        <img src="media/img/jalan-slide7.png" alt="jalan" class="w-76 sec7-road" id="sec7Road">
        <!-- Tanda tanya (draggable) -->
        <img src="media/img/tanya-slide7.png" alt="tanya" class="w-26 jalanTanya idle" id="sec7Q">
      </div>
    </div>

    <!-- RIGHT -->
    <div class="col-12 col-lg-6 px-4 position-relative justify-content-center d-flex">
      <div class="w-98 position-relative">
        <div class="row row1">
          <p class="fs-5vw poetsenOne yellow-3 text-uppercase lh-sm">Bingung arah tujuan hidup</p>
        </div>

        <div class="row py-4 w-83">
          <p class="playpenSans fs-4 purple-2 border-start border-5 px-4 sec7-problem" id="sec7ProblemText">
            Semua pilihan hidup rasanya membingungkan. Kamu membayangkan masa depan yang kamu miliki tampaknya samar.
          </p>
        </div>

        <!-- SOLUSI (muncul saat tanda tanya digeser) -->
        <div class="row py-2 w-83 sec7-solution" id="sec7SolutionWrap">
          <div class="sec7-solution-card" id="sec7SolutionCard">
            <p class="poetsenOne text-uppercase mb-2 purple-3" style="font-size:1.2rem;">Bagaimana Menghadapinya?</p>

            <p class="playpenSans mb-3 purple-3" style="opacity:.95;">
              Coba kamu catat hal yang buat diri kamu jadi lebih hidup dan hal yang bikin kamu penasaran akhir-akhir ini.
              Mulai dari situ bisa bantu kamu kenal diri kamu lebih dalam. Nggak harus langsung tahu kok, apa tujuan hidup kamu —
              <b>Sedikit clue atau arahan itu udah cukup</b> untuk mulai langkah kecil kamu.
            </p>

            <div class="sec7-example playpenSans purple-3">
              <b>Contoh:</b><br>
              “Aku suka bikin video pendek dan tertarik dengan isu lingkungan.
              Mungkin aku bisa mulai bikin konten edukatif tentang gaya hidup ramah lingkungan.”
            </div>
          </div>
        </div>

        <div class="row pt-2 me-4 w-83">
          <p class="poetsenOne fs-2 border-top border-5 border-warning rounded-5 bg-white purple-3 px-5 lh-sm py-4 text-center sec7-problem" id="sec7Badge">
            Ini bisa jadi tanda kalau kamu sedang mengalami <b>krisis identitas</b>
          </p>
        </div>
      </div>
    </div>
  </div>

</section>

<script>
(function(){
  const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

  const q = document.getElementById('sec7Q');
  const road = document.getElementById('sec7Road');
  const solutionWrap = document.getElementById('sec7SolutionWrap');
  const solutionCard = document.getElementById('sec7SolutionCard');
  const problems = document.querySelectorAll('.bg-sec7 .sec7-problem');

  if(!q || !solutionWrap) return;

  // Drag state
  let dragging = false;
  let startX = 0;
  let currentX = 0;
  let maxDrag = 220;

  // Idle control
  const IDLE_THRESHOLD = 0.08; // 8% of max
  let idleAllowed = true;

  function recalc(){
    // Sesuaikan jarak drag dengan layar
    maxDrag = Math.round(Math.min(260, window.innerWidth * 0.22));
    render();
    applyIdleRules();
  }
  window.addEventListener('resize', recalc);

  function progress(){
    return maxDrag === 0 ? 0 : (currentX / maxDrag);
  }

  function render(){
    const p = progress();

    // 1) tanda tanya geser + mengecil (parallax feel)
    const x = p * maxDrag;
    const y = p * 18;
    const scale = 1 - p * 0.18;
    q.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px)) scale(${scale})`;
    q.style.opacity = `${1 - p * 0.20}`;

    // 2) jalan geser pelan (depth)
    if(road){
      road.style.transform = `translate3d(${p * -18}px, ${p * 6}px, 0)`;
    }

    // 3) problem fade out
    problems.forEach(el=>{
      el.style.opacity = `${1 - p}`;
      el.style.filter = `blur(${p * 8}px)`;
      el.style.transform = `translateY(${p * -6}px)`;
    });

    // 4) solusi fade in (mulai setelah 25%)
    const p2 = clamp((p - 0.25) / 0.75, 0, 1);
    solutionWrap.style.opacity = `${p2}`;
    solutionWrap.style.filter = `blur(${(1 - p2) * 10}px)`;
    solutionWrap.style.transform = `translateY(${(1 - p2) * 12}px)`;

    // pop halus pada card
    if(solutionCard){
      const s = 1 - (1 - p2) * 0.02;
      solutionCard.style.transform = `scale(${s})`;
    }
  }

  function applyIdleRules(){
    const p = progress();

    // kalau sudah geser agak jauh, idle dimatikan sampai balik ke awal
    if (p > 0.15) idleAllowed = false;
    if (p < IDLE_THRESHOLD) idleAllowed = true;

    if (!dragging && idleAllowed && p < IDLE_THRESHOLD) q.classList.add('idle');
    else q.classList.remove('idle');
  }

  function getClientX(ev){
    if (ev.touches && ev.touches.length) return ev.touches[0].clientX;
    if (ev.changedTouches && ev.changedTouches.length) return ev.changedTouches[0].clientX;
    return ev.clientX;
  }

  function onDown(ev){
    dragging = true;
    q.classList.remove('idle');
    q.classList.add('dragging');
    startX = getClientX(ev);

    // capture supaya move selalu kebaca
    if (ev.pointerId != null && q.setPointerCapture) q.setPointerCapture(ev.pointerId);

    if (ev.cancelable) ev.preventDefault();
  }

  function onMove(ev){
    if (!dragging) return;
    const x = getClientX(ev);
    const dx = x - startX;
    startX = x;
    currentX = clamp(currentX + dx, 0, maxDrag);
    render();
    if (ev.cancelable) ev.preventDefault();
  }

  function snapTo(target){
    const start = currentX;
    const dist = target - start;
    const dur = 220;
    const t0 = performance.now();

    function tick(t){
      const u = clamp((t - t0)/dur, 0, 1);
      const eased = 1 - Math.pow(1 - u, 3);
      currentX = start + dist * eased;
      render();
      if (u < 1) requestAnimationFrame(tick);
      else applyIdleRules();
    }
    requestAnimationFrame(tick);
  }

  function onUp(){
    if (!dragging) return;
    dragging = false;
    q.classList.remove('dragging');

    const p = progress();
    const target = (p > 0.5) ? maxDrag : 0;
    snapTo(target);
  }

  // Pointer events
  q.addEventListener('pointerdown', onDown);
  q.addEventListener('pointermove', onMove);
  q.addEventListener('pointerup', onUp);
  q.addEventListener('pointercancel', onUp);

  // Fallbacks (mouse/touch)
  q.addEventListener('touchstart', onDown, { passive:false });
  window.addEventListener('touchmove', onMove, { passive:false });
  window.addEventListener('touchend', onUp);
  window.addEventListener('touchcancel', onUp);

  q.addEventListener('mousedown', onDown);
  window.addEventListener('mousemove', onMove);
  window.addEventListener('mouseup', onUp);

  // Init
  recalc();
  currentX = 0;
  render();
  applyIdleRules();
})();
</script>

</body>
</html>
